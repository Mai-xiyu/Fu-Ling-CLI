# ç¬¦çµæ‰©å±•æŒ‡å—

## ğŸ¯ æ¦‚è¿°

ç¬¦çµè®¾è®¡ä¸ºå¯æ‰©å±•çš„ã€‚ä½ å¯ä»¥ï¼š
- åˆ›å»ºè‡ªå®šä¹‰å‘½ä»¤
- æ·»åŠ æ–°çš„AIæä¾›å•†
- å¼€å‘æ’ä»¶
- è‡ªå®šä¹‰ä¸»é¢˜
- é›†æˆå…¶ä»–å·¥å…·

## ğŸš€ å¿«é€Ÿæ‰©å±•ç¤ºä¾‹

### 1. åˆ›å»ºè‡ªå®šä¹‰å‘½ä»¤

**æ–‡ä»¶**: `~/.config/fuling/plugins/my_commands.py`
```python
import click
from fuling import format_text

@click.command()
@click.argument('name')
def hello(name):
    """æ‰“æ‹›å‘¼"""
    click.echo(format_text(f"ä½ å¥½, {name}!", "success"))

# æ³¨å†Œåˆ°ç¬¦çµ
def register_commands(cli):
    cli.add_command(hello)
```

**ä½¿ç”¨**:
```bash
# æ·»åŠ åˆ°config.yaml
plugins:
  - ~/.config/fuling/plugins/my_commands.py

# ä½¿ç”¨å‘½ä»¤
fl hello ä¸–ç•Œ
```

### 2. æ·»åŠ ç®€å•AIæä¾›å•†

**æ–‡ä»¶**: `~/.config/fuling/providers/custom_provider.py`
```python
from fuling.fuling_ai import AIProvider
from typing import Dict, Any, List, Optional

class CustomProvider(AIProvider):
    def __init__(self, config: Dict[str, Any]):
        super().__init__(config)
        self.api_url = config.get('api_url', '')
    
    def chat_completion(self, messages: List[Dict], **kwargs) -> str:
        # ä½ çš„è‡ªå®šä¹‰AIé›†æˆ
        return "æ¥è‡ªè‡ªå®šä¹‰æä¾›å•†çš„å“åº”"
    
    def explain_command(self, command: str, context: Optional[str] = None) -> str:
        return f"è‡ªå®šä¹‰è§£é‡Š: {command}"
```

## ğŸ“¦ æ’ä»¶ç³»ç»Ÿ

### æ’ä»¶ç»“æ„
```
my_fuling_plugin/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ commands.py      # è‡ªå®šä¹‰å‘½ä»¤
â”œâ”€â”€ providers.py     # AIæä¾›å•†
â”œâ”€â”€ themes.py        # è‡ªå®šä¹‰ä¸»é¢˜
â””â”€â”€ config.yaml      # æ’ä»¶é…ç½®
```

### æ’ä»¶æ³¨å†Œ
```python
# åœ¨æ’ä»¶çš„ __init__.py ä¸­
from .commands import register_commands
from .providers import CustomProvider

__all__ = ['register_commands', 'CustomProvider']
```

### é…ç½®
```yaml
# config.yaml
plugins:
  - /path/to/plugin1
  - /path/to/plugin2
  
plugin_settings:
  plugin1:
    enabled: true
    config_key: value
```

## ğŸ¤– è‡ªå®šä¹‰AIæä¾›å•†

### æä¾›å•†æ¥å£
```python
from abc import ABC, abstractmethod

class BaseAIProvider(ABC):
    @abstractmethod
    def chat_completion(self, messages: List[Dict], **kwargs) -> str:
        pass
    
    @abstractmethod
    def explain_command(self, command: str, context: str = None) -> str:
        pass
    
    @abstractmethod
    def suggest_commands(self, context: str = None) -> List[Dict]:
        pass
```

### ç¤ºä¾‹ï¼šæœ¬åœ°æ–‡ä»¶æä¾›å•†
```python
class FileProvider(AIProvider):
    def __init__(self, config):
        super().__init__(config)
        self.knowledge_file = config.get('knowledge_file', '')
    
    def explain_command(self, command, context=None):
        # ä»æœ¬åœ°çŸ¥è¯†åº“è¯»å–
        with open(self.knowledge_file, 'r') as f:
            knowledge = json.load(f)
        return knowledge.get(command, "çŸ¥è¯†åº“ä¸­æœªæ‰¾åˆ°æ­¤å‘½ä»¤")
```

## ğŸ¨ è‡ªå®šä¹‰ä¸»é¢˜

### ä¸»é¢˜ç»“æ„
```python
from fuling.fuling_theme import Theme

class MyCustomTheme(Theme):
    def get_banner(self):
        return """
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘     æˆ‘çš„è‡ªå®šä¹‰ä¸»é¢˜       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """
    
    def format_text(self, text, style=None):
        # è‡ªå®šä¹‰æ ¼å¼åŒ–é€»è¾‘
        symbols = {
            'success': 'ğŸ‰',
            'error': 'ğŸ’¥',
            'info': 'ğŸ’¡',
        }
        symbol = symbols.get(style, 'â€¢')
        return f"{symbol} {text}"
```

### æ³¨å†Œä¸»é¢˜
```python
# æ·»åŠ åˆ°config.yaml
theme:
  name: "mycustom"
  # ä¸»é¢˜é…ç½®
```

## ğŸ”Œ é›†æˆç¤ºä¾‹

### 1. ä¸Gité›†æˆ
```python
@click.command()
@click.option('--message', '-m', required=True)
def git_commit(message):
    """ä½¿ç”¨AIç”Ÿæˆæäº¤ä¿¡æ¯çš„Gitæäº¤"""
    from fuling import chat_completion
    
    # ä½¿ç”¨AIç”Ÿæˆæäº¤ä¿¡æ¯
    messages = [
        {"role": "system", "content": "ç”Ÿæˆgitæäº¤ä¿¡æ¯"},
        {"role": "user", "content": f"æ›´æ”¹: {message}"}
    ]
    
    ai_message = chat_completion(messages)
    os.system(f'git commit -m "{ai_message}"')
```

### 2. ç³»ç»Ÿç›‘æ§æ’ä»¶
```python
@click.command()
def system_health():
    """æ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€"""
    import psutil
    
    cpu = psutil.cpu_percent()
    memory = psutil.virtual_memory().percent
    disk = psutil.disk_usage('/').percent
    
    click.echo(f"CPU: {cpu}%")
    click.echo(f"å†…å­˜: {memory}%")
    click.echo(f"ç£ç›˜: {disk}%")
```

### 3. DockeråŠ©æ‰‹
```python
@click.command()
@click.argument('service')
def docker_logs(service):
    """æ˜¾ç¤ºå¹¶è¿‡æ»¤Dockeræ—¥å¿—"""
    import subprocess
    
    # è·å–æ—¥å¿—
    result = subprocess.run(
        ['docker', 'logs', '--tail', '100', service],
        capture_output=True,
        text=True
    )
    
    # ä½¿ç”¨AIåˆ†ææ—¥å¿—
    from fuling import explain_command
    analysis = explain_command(f"dockeræ—¥å¿—åˆ†æ: {result.stdout[:500]}")
    
    click.echo(analysis)
```

## ğŸ§ª æµ‹è¯•æ‰©å±•

### å•å…ƒæµ‹è¯•
```python
import pytest
from my_plugin.commands import hello

def test_hello_command():
    from click.testing import CliRunner
    
    runner = CliRunner()
    result = runner.invoke(hello, ['ä¸–ç•Œ'])
    
    assert result.exit_code == 0
    assert 'ä½ å¥½' in result.output
```

### é›†æˆæµ‹è¯•
```python
def test_plugin_integration():
    # æµ‹è¯•æ’ä»¶æ˜¯å¦æ­£ç¡®åŠ è½½
    from fuling import get_config
    config = get_config()
    
    assert 'plugins' in config
    assert 'my_plugin' in config['plugins']
```

## ğŸ“ æ‰©å±•é¡¹ç›®ç»“æ„

### æ¨èç»“æ„
```
fuling-extension/
â”œâ”€â”€ pyproject.toml          # åŒ…é…ç½®
â”œâ”€â”€ README.md              # æ–‡æ¡£
â”œâ”€â”€ src/
â”‚   â””â”€â”€ fuling_extension/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ commands.py
â”‚       â”œâ”€â”€ providers.py
â”‚       â””â”€â”€ themes.py
â”œâ”€â”€ tests/                 # æµ‹è¯•
â””â”€â”€ examples/             # ä½¿ç”¨ç¤ºä¾‹
```

### åŒ…é…ç½®
```toml
# pyproject.toml
[project]
name = "fuling-extension-example"
version = "0.1.0"
description = "ç¬¦çµæ‰©å±•ç¤ºä¾‹"

[project.entry-points."fuling.plugins"]
example = "fuling_extension:register_plugin"
```

## ğŸš€ å‘å¸ƒæ‰©å±•

### 1. æ‰“åŒ…æ‰©å±•
```bash
# æ„å»ºåŒ…
python -m build

# ä¸Šä¼ åˆ°PyPI
twine upload dist/*
```

### 2. åœ¨GitHubåˆ†äº«
```bash
# åˆ›å»ºä»“åº“
git init
git add .
git commit -m "åˆå§‹æäº¤"
git remote add origin https://github.com/username/fuling-extension.git  # ç¤ºä¾‹é“¾æ¥ï¼Œè¯·æ›¿æ¢ä¸ºä½ çš„ä»“åº“
git push -u origin main
```

### 3. ç¤¾åŒºåˆ†äº«
- æ·»åŠ åˆ°ç¬¦çµæ’ä»¶æ³¨å†Œè¡¨
- åœ¨GitHubè®¨è®ºåŒºåˆ†äº«
- åˆ›å»ºæ–‡æ¡£
- æä¾›ç¤ºä¾‹

## ğŸ”§ é«˜çº§ä¸»é¢˜

### 1. é…ç½®ç®¡ç†
```python
# åŠ¨æ€é…ç½®
from fuling.fuling_core import get_config, config

def update_config():
    current = get_config()
    current['custom_key'] = 'value'
    config.save_config(current)
```

### 2. äº‹ä»¶ç³»ç»Ÿ
```python
# è®¢é˜…äº‹ä»¶
def on_command_executed(command, result):
    print(f"å‘½ä»¤æ‰§è¡Œ: {command}")
    # è®°å½•åˆ°æ–‡ä»¶ã€å‘é€é€šçŸ¥ç­‰

# æ³¨å†Œäº‹ä»¶å¤„ç†å™¨
register_event_handler('command_executed', on_command_executed)
```

### 3. ç¼“å­˜
```python
from functools import lru_cache

@lru_cache(maxsize=100)
def cached_explanation(command):
    # æ˜‚è´µæ“ä½œ
    return expensive_ai_call(command)
```

## ğŸ“š èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [ç¬¦çµAPIå‚è€ƒ](API_REFERENCE.md)
- [æ’ä»¶å¼€å‘æŒ‡å—](PLUGIN_DEVELOPMENT.md)
- [ä¸»é¢˜å®šåˆ¶](THEME_CUSTOMIZATION.md)

### ç¤¾åŒºèµ„æº
- [GitHubä»“åº“](https://github.com/mai-xiyu/Fu-Ling-CLI)
- [æ’ä»¶ç¤ºä¾‹](https://github.com/mai-xiyu/Fu-Ling-CLI/tree/main/examples)
- [è®¨è®ºè®ºå›](https://github.com/mai-xiyu/Fu-Ling-CLI/discussions)

### å·¥å…·å’Œåº“
- Click: CLIæ¡†æ¶
- PyYAML: é…ç½®ç®¡ç†
- Requests: HTTPå®¢æˆ·ç«¯
- Pytest: æµ‹è¯•æ¡†æ¶

---

**ç«‹å³å¼€å§‹æ‰©å±•ç¬¦çµï¼æŸ¥çœ‹examplesç›®å½•è·å–æ›´å¤šçµæ„Ÿã€‚** ğŸš€